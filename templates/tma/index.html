{% extends 'layouts/master.html' %}

{% set title = "Tinggi Muka Air" %}
{% block css %}

    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block content %}
    <section class="content-header">
        <h1>{{ title }}</h1>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="/">Home</a>
            </li>
            <li class="breadcrumb-item">{{ title }}</li>
        </ol>
    </section>
    <div class="table-responsive">
        <table class="table table-hover table-bordered table-grid">
            <thead>
                <tr>
                    <th class="align-middle" rowspan="3">No</th>
                    <th class="align-middle text-center" rowspan="3">Lokasi / Pos</th>
                    <th class="align-middle text-center" colspan="3" rowspan="2">Level Siaga</th>
                    <th class="text-center" colspan="1">
                        <a href="{{ path_for('tma') }}?sampling={{ prev_date }}">
                            &lt;<i class="fas fa-chevron-left"></i>
                        </a>
                    </th>
                    <th class="text-center" colspan="6">
                        <span id='datepicker'>{{ sampling }}</span>
                    </th>
                    <th class="text-center" colspan="1">
                        <a href="{{ path_for('tma') }}?sampling={{ next_date }}">
                            &gt;<i class="fas fa-chevron-right"></i>
                        </a>
                    </th>
                </tr>
                <tr>
                    <th class="text-center" colspan="5">Telemetri (meter)</th>
                    <th class="text-center" colspan="3">Manual</th>
                </tr>
                <tr>
                    <th class="text-center">Hijau</th>
                    <th class="text-center">Kuning</th>
                    <th class="text-center">Merah</th>
                    <th>06</th>
                    <th>12</th>
                    <th>18</th>
                    <th>00</th>
                    <th>*</th>
                    <th>06</th>
                    <th>12</th>
                    <th>18</th>
                </tr>
            </thead>
            <tbody>
                {% for r in result %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>
                            <a href="{{ path_for('tma.show', {'id': r.lokasi.id}) }}">{{ r.lokasi.nama }}</a>
                        </td>
                        <td>
                            <i>siaga1</i>
                        </td>
                        <td>
                            <i>siaga2</i>
                        </td>
                        <td>
                            <i>siaga3</i>
                        </td>
                        <td>{{ r.jam6 }}</td>
                        <td>{{ r.jam12 }}</td>
                        <td>{{ r.jam18 }}</td>
                        <td>{{ r.jam0 }}</td>
                        <td>
                            {{ r.latest_wlev }}
                            {% if r.latest_time is not empty %}
                                <br>
                                <small>{{ r.latest_time }}</small>
                            {% endif %}
                        </td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block js %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
    <script>
        $('#datepicker').datepicker({todayHighlight: true, autoclose: true, format: 'yyyy-mm-dd'});
        $('#datepicker').on('changeDate', function () {
            window.location = "{ path_for('tma') }}?sampling=" + $('#datepicker').datepicker('getFormattedDate')
        });
    </script>
{% endblock %}
